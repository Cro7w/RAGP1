<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard | Travelly â€“ Escape the Ordinary</title>
    <meta name="description" content="Your personal travel dashboard with your AI companion. Discover destinations and plan your next adventure with Travelly.">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/style.css">
</head>
<body class="home-page">
    <div class="hero-background"></div>
    <div class="overlay"></div>

    <nav class="glass-nav">
        <div class="nav-content">
            <div class="nav-brand">
                <h2>Travelly</h2>
            </div>
            <div class="nav-user">
                <span class="user-greeting" data-testid="text-user-greeting">Welcome back!</span>
                <button class="btn btn-secondary" id="logout-btn" data-testid="button-logout">Logout</button>
            </div>
        </div>
    </nav>

    <div class="container home-container">
        <div class="welcome-section">
            <h1 class="welcome-title" data-testid="text-welcome-title">Welcome to Your Travel Dashboard</h1>
            <p class="welcome-subtitle">Your AI companion is ready to help you explore the world</p>
        </div>

        <div class="dashboard-grid">
            <div class="glass-card dashboard-card">
                <div class="card-icon">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polygon points="3 11 22 2 13 21 11 13 3 11"/>
                    </svg>
                </div>
                <h3>Explore Destinations</h3>
                <p>Discover amazing places around the world</p>
            </div>
            <div class="glass-card dashboard-card">
                <div class="card-icon">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
                        <line x1="16" y1="2" x2="16" y2="6"/>
                        <line x1="8" y1="2" x2="8" y2="6"/>
                        <line x1="3" y1="10" x2="21" y2="10"/>
                    </svg>
                </div>
                <h3>Plan Your Trip</h3>
                <p>Create your perfect itinerary</p>
            </div>
            <div class="glass-card dashboard-card">
                <div class="card-icon">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="5"/>
                        <line x1="12" y1="1" x2="12" y2="3"/>
                        <line x1="12" y1="21" x2="12" y2="23"/>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/>
                        <line x1="1" y1="12" x2="3" y2="12"/>
                        <line x1="21" y1="12" x2="23" y2="12"/>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/>
                    </svg>
                </div>
                <h3>Get Recommendations</h3>
                <p>AI-powered travel suggestions</p>
            </div>
        </div>
    </div>

    <div id="floating-avatar" class="floating-avatar" data-testid="floating-avatar">
        <div class="avatar-pulse"></div>
        <div class="avatar-image" id="avatar-icon-container"></div>
    </div>

    <script src="/floating-avatar.js"></script>
    <script>
        document.getElementById('logout-btn').addEventListener('click', async () => {
            try {
                const response = await fetch('/api/logout', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' }
                });
                if (response.ok) {
                    window.location.href = '/';
                }
            } catch (error) {
                console.error('Logout error:', error);
            }
        });

        async function loadUserInfo() {
            try {
                const response = await fetch('/api/get-user');
                if (response.ok) {
                    const user = await response.json();
                    if (user.displayName) {
                        document.querySelector('.user-greeting').textContent = `Welcome, ${user.displayName}!`;
                        document.querySelector('.welcome-title').textContent = `Welcome Back, ${user.displayName}!`;
                    }
                } else if (response.status === 401) {
                    window.location.href = '/';
                }
            } catch (error) {
                console.error('Error loading user info:', error);
            }
        }
        loadUserInfo();
    </script>
</body>
</html>
